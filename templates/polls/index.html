{% extends "base.html" %} 

{% block content %}

<div class="container">
    <div class="row">
      <div class="col-md-9 mt-3 left">
        {% for question in questions %}
        <div class="card mb-4">
            <div class="card-body">
                <h1>{{ question.question_text }}</h1>
                {% for plot in question.plot_set.all %}
                <div class="card my-3  px-5">
                  <div class="card-body">
                    <embed type="image/svg+xml" src={{graph_data|safe}} style='max-width:1000px'/>
                    <h4 class="card-title text-center" id="graph-title">{{question.question_text}}</h4>
                    <div id="plot-div{{question.id}}">{{plot.div | safe}}</div>
                    <div id="plot-script">{{plot.script | safe}}</div>
                    <div id="plotly{{question.id}}"></div>
                    <div id="graph{{question.id}}"></div>
                  </div>
                </div>  
                {% endfor %}   
                {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

                <form action="{% url 'polls:vote' question.id %}" method="post">
                {% csrf_token %}

                  
                {% for choice in question.choice_set.all %}
                    <input type="radio" name="choice" id="choice{{ forloop.counter }}"  value="{{ choice.id }}">
                    <label for="choice{{ forloop.counter }}">{{ choice.choice_text }}</label><br>
                {% endfor %}
                <input type="submit" class="btn btn-primary js-vote" id="vote{{ question.id }}" data-catid="{{ question.id }}" value="Vote">
                </form>
            </div>
            
        </div>
        

        <div class="card">
            
          <p id="voted-text" class="js-message">Not voted</p>
          <ul>
          {% for choice in question.choice_set.all %}
              <li>{{ choice.choice_text }} -- <div id="vote-num{{ choice.id }}">{{ choice.votes }}</div> vote{{ choice.votes|pluralize }}</li>
          {% endfor %}
          </ul>
        </div>
        {% endfor %}
      </div>

      <div class="col-md-3 float-right">

        {% include 'widgets/sidebar.html' %} 

      </div>
    </div>
</div>

<script type="text/javascript">

    var a = "{{ question.question_text }}";

</script>

{% endblock content %}